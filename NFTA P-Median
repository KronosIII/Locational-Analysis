import xlrd
import numpy as np
import math
import pandas as pd 



#Creating a Numpy Matrix of the lat and long of Current Telsa Locations & Mean Center Points of VA
book = xlrd.open_workbook('/Users/Ramzi/Dropbox/LatLongNOTesla.xlsx')
sheet = book.sheet_by_name('Sheet1')
data = [[sheet.cell_value(r, c) for c in range(sheet.ncols)] for r in range(sheet.nrows)]
# Profit !
#print (data) 
# Check if Data prints correctly


#Straight Line distance matrix calculation
def spherical_dist(pos1, pos2, r=3958.75):
    pos1 = pos1 * np.pi / 180
    pos2 = pos2 * np.pi / 180
    cos_lat1 = np.cos(pos1[..., 0])
    cos_lat2 = np.cos(pos2[..., 0])
    cos_lat_d = np.cos(pos1[..., 0] - pos2[..., 0])
    cos_lon_d = np.cos(pos1[..., 1] - pos2[..., 1])
    return r * np.arccos(cos_lat_d - cos_lat1 * cos_lat2 * (1 - cos_lon_d))


locations_1 = np.array(data)


soup = spherical_dist(locations_1[:, None], locations_1)
print(spherical_dist(locations_1[:, None], locations_1))

Locations = print(np.prod(soup.shape))


#Save as an OD-Matrix First 11 are Tesla The rest are mean center points of VA
df = pd.DataFrame(soup)
df.to_csv("Excell File")
